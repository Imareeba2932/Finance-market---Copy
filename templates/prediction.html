{% extends 'base.html' %}
{% block content %}
<div class="row g-4">
  <div class="col-12 d-flex align-items-baseline justify-content-between mb-2">
    <div>
      <h1 class="page-title">Market Intelligence</h1>
      <p class="text-muted mb-0">AI-powered country similarity analysis and recommendations</p>
    </div>
  </div>

  {% if error %}
  <div class="col-12">
    <div class="alert alert-warning d-flex align-items-center">
      <i class="bi bi-exclamation-triangle me-2"></i>
      {{ error }}
    </div>
  </div>
  {% else %}
  <div class="col-lg-4">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <div>Analysis Parameters</div>
        <div class="small text-muted">Select market</div>
      </div>
      <div class="card-body">
        <form method="get">
          <div class="mb-4">
            <label class="form-label d-flex justify-content-between">
              <span>Base Country</span>
              <span class="small text-muted">Reference market</span>
            </label>
            <select class="form-select form-select-lg mb-3" name="country">
              {% for c in countries %}
                <option value="{{ c }}" {% if c == selected_country %}selected{% endif %}>{{ c }}</option>
              {% endfor %}
            </select>
            <div class="text-muted small mb-3">
              <i class="bi bi-info-circle me-1"></i>
              Select a country to find similar markets based on macro factors
            </div>
            <button class="btn btn-primary w-100">
              <i class="bi bi-search me-1"></i>
              Find Similar Markets
            </button>
          </div>

          {% if selected_country %}
          <div class="analysis-summary">
            <div class="small text-muted mb-2">Analysis Criteria</div>
            <div class="d-flex flex-column gap-2">
              <div class="metric-chip">
                <i class="bi bi-graph-up me-1"></i>
                GDP Growth Rate
              </div>
              <div class="metric-chip">
                <i class="bi bi-currency-dollar me-1"></i>
                Inflation Rate
              </div>
              <div class="metric-chip">
                <i class="bi bi-shield-check me-1"></i>
                Credit Rating
              </div>
            </div>
          </div>
          {% endif %}
        </form>
      </div>
    </div>
  </div>

  {% if recs_table_html %}
  <div class="col-lg-8">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <div>Market Similarity Analysis</div>
        <div class="small text-muted">Top 5 similar markets</div>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          {{ recs_table_html|safe }}
        </div>
        <div class="chart-insights mt-4">
          <h6>Analysis Insights</h6>
          <p class="text-muted mb-1">Markets are ranked by their similarity to {{ selected_country }} across key economic indicators.</p>
          <div class="row g-3 mt-2">
            <div class="col-md-6">
              <div class="insight-card">
                <h6 class="small">Interpretation Guide</h6>
                <ul class="small text-muted mb-0 ps-3">
                  <li>Higher similarity score = more comparable market conditions</li>
                  <li>Consider both score and individual metrics</li>
                  <li>Check for regional vs global patterns</li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="insight-card">
                <h6 class="small">Application Tips</h6>
                <ul class="small text-muted mb-0 ps-3">
                  <li>Use for portfolio diversification planning</li>
                  <li>Identify potential market opportunities</li>
                  <li>Benchmark performance expectations</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
  {% endif %}
</div>
{% endblock %}


