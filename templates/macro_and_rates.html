{% extends 'base.html' %}
{% block content %}
<div class="row g-4">
  <div class="col-12 d-flex align-items-baseline justify-content-between mb-2">
    <div>
      <h1 class="page-title">Macro & Interest Rates Analysis</h1>
      <p class="text-muted mb-0">Deep dive into growth, inflation, and policy dynamics</p>
    </div>
  </div>

  <div class="col-lg-3">
    <form class="card card-filter p-3 sticky-sidebar" method="get">
      <div class="d-flex align-items-center justify-content-between mb-2">
        <h6 class="mb-0">Analysis Filters</h6>
        <span class="small text-muted">Customize view</span>
      </div>
      <div class="mb-3">
        <label class="form-label d-flex justify-content-between">
          <span>Countries</span>
          <span class="small text-muted">{{ selected.countries|length or 0 }} selected</span>
        </label>
        <select class="form-select" name="country" multiple size="6">
          {% for c in meta.countries %}
            <option value="{{ c }}" {% if c in selected.countries %}selected{% endif %}>{{ c }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label d-flex justify-content-between">
          <span>Credit Ratings</span>
          <span class="small text-muted">{{ selected.ratings|length or 0 }} selected</span>
        </label>
        <select class="form-select" name="rating" multiple size="4">
          {% for r in meta.credit_ratings %}
            <option value="{{ r }}" {% if r in selected.ratings %}selected{% endif %}>{{ r }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Date Range</label>
        <div class="row g-2">
          <div class="col-6">
            <input class="form-control" type="date" name="start_date" value="{{ selected.start_date or '' }}" />
          </div>
          <div class="col-6">
            <input class="form-control" type="date" name="end_date" value="{{ selected.end_date or '' }}" />
          </div>
        </div>
      </div>
      <button class="btn btn-primary w-100">Apply Filters</button>

      
    </form>
  </div>

  <div class="col-lg-9">
    <div class="chart-grid">
      <!-- GDP Growth -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>GDP Growth (%)</div>
            <div class="chart-legend small text-muted">Higher = faster growth</div>
          </div>
          <div class="card-body">
            {{ bar_gdp|safe if bar_gdp else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Economic Growth</h6>
              <p class="text-muted mb-1">Countries ranked by GDP growth rate. Higher bars indicate faster economic expansion.</p>
              <div class="small text-muted">ðŸ’¡ Compare with unemployment and inflation for full economic health check.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Inflation Rate -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Inflation Rate (%)</div>
            <div class="chart-legend small text-muted">Price stability indicator</div>
          </div>
          <div class="card-body">
            {{ bar_infl|safe if bar_infl else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Price Trends</h6>
              <p class="text-muted mb-1">Current inflation rates across countries. Lower, stable inflation generally supports economic stability.</p>
              <div class="small text-muted">ðŸ’¡ Check if policy rates are above inflation (positive real rates).</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Policy Rate -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Policy Interest Rate (%)</div>
            <div class="chart-legend small text-muted">Central bank rates</div>
          </div>
          <div class="card-body">
            {{ bar_policy|safe if bar_policy else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Monetary Policy</h6>
              <p class="text-muted mb-1">Current central bank policy rates. Higher rates typically aim to control inflation but can slow growth.</p>
              <div class="small text-muted">ðŸ’¡ Compare with 10Y yields to understand the yield curve shape.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Unemployment Box Plot -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Unemployment Distribution (%)</div>
            <div class="chart-legend small text-muted">Box: typical range</div>
          </div>
          <div class="card-body">
            {{ box_unemp|safe if box_unemp else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Labor Markets</h6>
              <p class="text-muted mb-1">Box plots show the typical unemployment range. Lower rates generally indicate stronger labor markets.</p>
              <div class="small text-muted">ðŸ’¡ Outlier points may signal structural issues or measurement differences.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Inflation vs GDP -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Growth vs Inflation Analysis</div>
            <div class="chart-legend small text-muted">Each point = one country</div>
          </div>
          <div class="card-body">
            {{ scatter_infl_gdp|safe if scatter_infl_gdp else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Growth-Inflation Balance</h6>
              <p class="text-muted mb-1">Scatter plot reveals the relationship between economic growth and inflation across countries.</p>
              <div class="small text-muted">ðŸ’¡ Look for clusters of similar economies and potential outliers.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Policy vs 10Y Yield -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Rate Structure Analysis</div>
            <div class="chart-legend small text-muted">Policy vs long-term rates</div>
          </div>
          <div class="card-body">
            {{ scatter_policy_yield|safe if scatter_policy_yield else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Interest Rate Dynamics</h6>
              <p class="text-muted mb-1">Compare short-term policy rates with long-term market yields to understand rate expectations.</p>
              <div class="small text-muted">ðŸ’¡ Points below the diagonal suggest an inverted yield curve - potential slowdown signal.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}


