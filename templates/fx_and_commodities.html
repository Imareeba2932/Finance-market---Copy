{% extends 'base.html' %}
{% block content %}
<div class="row g-4">
  <div class="col-12 d-flex align-items-baseline justify-content-between mb-2">
    <div>
      <h1 class="page-title">FX & Commodities Analysis</h1>
      <p class="text-muted mb-0">Currency dynamics, commodity trends, and their macroeconomic implications</p>
    </div>
  </div>

  <div class="col-lg-3">
    <form class="card card-filter p-3 sticky-sidebar" method="get">
      <div class="d-flex align-items-center justify-content-between mb-2">
        <h6 class="mb-0">Market Filters</h6>
        <span class="small text-muted">Customize view</span>
      </div>
      <div class="mb-3">
        <label class="form-label d-flex justify-content-between">
          <span>Countries</span>
          <span class="small text-muted">{{ selected.countries|length or 0 }} selected</span>
        </label>
        <select class="form-select" name="country" multiple size="6">
          {% for c in meta.countries %}
            <option value="{{ c }}" {% if c in selected.countries %}selected{% endif %}>{{ c }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label d-flex justify-content-between">
          <span>Currencies</span>
          <span class="small text-muted">{{ selected.currencies|length if selected.currencies else 0 }} selected</span>
        </label>
        <select class="form-select" name="currency" multiple size="4">
          {% for cu in meta.currencies %}
            <option value="{{ cu }}" {% if selected.currencies and cu in selected.currencies %}selected{% endif %}>{{ cu }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Date Range</label>
        <div class="row g-2">
          <div class="col-6">
            <input class="form-control" type="date" name="start_date" value="{{ selected.start_date or '' }}" />
          </div>
          <div class="col-6">
            <input class="form-control" type="date" name="end_date" value="{{ selected.end_date or '' }}" />
          </div>
        </div>
      </div>
      <button class="btn btn-primary w-100">Apply Filters</button>

      
    </form>
  </div>

  <div class="col-lg-9">
    <div class="chart-grid">
      <!-- Exchange Rate Level -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Exchange Rate vs USD</div>
            <div class="chart-legend small text-muted">Higher = weaker currency</div>
          </div>
          <div class="card-body">
            {{ bar_fx_level|safe if bar_fx_level else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Currency Strength</h6>
              <p class="text-muted mb-1">Current exchange rates against USD. Higher values indicate weaker local currencies.</p>
              <div class="small text-muted">ðŸ’¡ Consider purchasing power and trade impacts of currency levels.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Currency YTD Change -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Currency Change YTD (%)</div>
            <div class="chart-legend small text-muted">Green = appreciation, Red = depreciation</div>
          </div>
          <div class="card-body">
            {{ bar_fx_ytd|safe if bar_fx_ytd else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Currency Momentum</h6>
              <p class="text-muted mb-1">Year-to-date currency performance vs USD. Shows relative strength and potential trends.</p>
              <div class="small text-muted">ðŸ’¡ Combine with exchange rate levels for complete currency assessment.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Oil vs Commodities -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Oil Price vs Commodity Index</div>
            <div class="chart-legend small text-muted">Relationship analysis</div>
          </div>
          <div class="card-body">
            {{ scatter_oil|safe if scatter_oil else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Energy-Commodity Link</h6>
              <p class="text-muted mb-1">Scatter plot showing the relationship between oil prices and broader commodity markets.</p>
              <div class="small text-muted">ðŸ’¡ Look for divergences that might signal sector-specific factors.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Gold Distribution -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Gold Price Distribution</div>
            <div class="chart-legend small text-muted">USD/Oz by country</div>
          </div>
          <div class="card-body">
            {{ violin_gold|safe if violin_gold else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Safe Haven Analysis</h6>
              <p class="text-muted mb-1">Gold price distributions across countries, showing market integration and local factors.</p>
              <div class="small text-muted">ðŸ’¡ Wide distributions may indicate market inefficiencies or data quality issues.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- FX Heatmap -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Currency Market Heatmap</div>
            <div class="chart-legend small text-muted">Cross-currency analysis</div>
          </div>
          <div class="card-body">
            {{ heatmap_fx|safe if heatmap_fx else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Currency Relationships</h6>
              <p class="text-muted mb-1">Heatmap showing relationships between currency levels and changes across markets.</p>
              <div class="small text-muted">ðŸ’¡ Dark colors indicate stronger relationships; look for currency clusters.</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Commodities vs Inflation -->
      <div class="chart-section">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>Commodity-Inflation Link</div>
            <div class="chart-legend small text-muted">Price pressures analysis</div>
          </div>
          <div class="card-body">
            {{ scatter_comm_infl|safe if scatter_comm_infl else '<div class="text-muted">No data available</div>' }}
            <div class="chart-insights">
              <h6>Price Dynamics</h6>
              <p class="text-muted mb-1">Relationship between commodity prices and inflation rates across economies.</p>
              <div class="small text-muted">ðŸ’¡ Consider pass-through effects and policy implications of commodity moves.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}


